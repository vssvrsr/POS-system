{% extends 'base.html' %}
{% load static %}
{% block title %}茵悦薈 | 商品進貨{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static 'adminlet-2.4.10/bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css' %}">
<link rel="stylesheet" href="{% static 'adminlet-2.4.10/bower_components/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css' %}">
{% endblock %}

{% block breadcrumb %}
<!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        進貨
      </h1>
      <ol class="breadcrumb">
        <li><a href="/app/index"><i class="fa fa-home"></i>主頁</a></li>
        <li>庫存管理</a></li>
        <li class="active">進貨</li>
      </ol>
    </section>
{% endblock %}

{% block content %}
<section class="content">
    <form role="form" method="POST">
        {% csrf_token %}
        <div class="row">
            <div class="col-md-6">
                <div class="box box-primary">
                    <div class="box-header with-border">
                        <h3 class="box-title">選擇</h3>
                    </div>
                    <div class="box-body">
                        <div class="form-group">
                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#selectStockModal">
                                選擇進貨商品
                            </button>
                        </div>                
                        <table id="stockTable" class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th>商品名稱</th>
                                <th>商品編號</th>
                                <th>從</th>
                                <th>數量</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for stock in selectedStockAll %}
                        <tr>
                            <th>{{stock.stock_name}}</a></th>
                            <th>{{stock.is_stock_id}}</th>
                            <th>
                                <select class="form-control" name="{{stock.is_stock_id}}_is_from_shop_id">
                                    <option value="">---</option>
                                    {% for shop in shopAll %}
                                    <option value="{{shop.shop_id}}">{{shop.shop_name}}</option>
                                    {% endfor %}
                                    <option value="out">外部</option>
                                </select>
                            </th>
                            <th><input type="text" class="form-control" name="{{stock.is_stock_id}}_is_qua" required></th>
                        </tr>
                        {% endfor %}
                        </tbody>
                        <tfoot>
                            <tr>
                                <th>商品名稱</th>
                                <th>商品編號</th>
                                <th>從</th>
                                <th>數量</th>
                            </tr>
                        </tfoot>
                    </table>                                       
                    </div>
                </div>               
            </div>
            <div class="col-md-6">
                <div class="box box-primary">
                    <div class="box-header with-border">
                        <h3 class="box-title">其他資訊</h3>
                    </div>
                    <div class="box-body">
                        <div class="form-group">
                            <label>進貨日期</label>
                            <div class="input-group date">
                                <div class="input-group-addon">
                                    <i class="fa fa-calendar"></i>
                                </div>
                                <input type="text" class="form-control pull-right" id="datepicker" name="ir_date">
                            </div>                          
                        </div>
                        <div class="form-group">
                            <label>備註</label>
                            <textarea type="text" class="form-control" name="ir_remark" row="3"></textarea>
                        </div>                    
                    </div>
                </div>
            </div>
      </div>
      <div class="pull-right">
          <a class="btn btn-default" href="/app/addStock">重整</a>
          <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#completeModal">
              完成
          </button>
      </div>
      <div class="modal fade" id="completeModal" tabindex="-1" role="dialog" aria-labelledby="completeModalTitle" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content">
                  <div class="modal-header">
                      <h2 class="modal-title" id="exampleModalLongTitle">注意</h2>
                  </div>
                  <div class="modal-body">
                      確定儲存嗎?
                  </div>
                  <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">返回</button>
                      <input type="submit" class="btn btn-primary" name="saveB" value="儲存"></input>
                  </div>
              </div>
          </div>
      </div>
      <div class="modal fade" id="selectStockModal" tabindex="-1" role="dialog" aria-labelledby="selectStockModalTitle" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="exampleModalLongTitle">選擇商品</h2>
                </div>
                <div class="modal-body">
                    <table id="selectStockTable" class="table table-bordered table-striped">
                        <thead>
                            <tr>
                            <th>商品名稱</th>
                            <th>商品編號</th>
                            <th>牌價</th>
                            <th>庫存量</th>
                            <th>選擇</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for stock in stockAll %}
                        <tr>
                            <th>{{stock.stock_name}}</th>
                            <th>{{stock.stock_id}}</th>
                            <th>{{stock.stock_price|default:"-"}}</th>
                            <th>{{stock.instock_qua|default:"-"}}</th>
                            <th>
                                <a href="/app/selectImport/{{irIdNow}}/{{stock.stock_id}}" class="btn btn-primary btn-xs">
                                    選擇
                                </a>
                            </th>
                        </tr>
                        {% endfor %}
                        </tbody>
                        <tfoot>
                            <tr>
                                <th>商品名稱</th>
                                <th>商品編號</th>
                                <th>牌價</th>
                                <th>庫存量</th>
                                <th>選擇</th>
                            </tr>
                        </tfoot>
                    </table>
                </div>        
              </div>
          </div>
      </div>
  </form>
</section>
{% endblock %}


{% block script %}
<script src="{% static 'adminlet-2.4.10/bower_components/datatables.net/js/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'adminlet-2.4.10/bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js' %}"></script>
<script src="{% static 'adminlet-2.4.10/bower_components/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js' %}"></script>
<script src="{% static 'adminlet-2.4.10/bower_components/bootstrap-datepicker/dist/locales/bootstrap-datepicker.zh-TW.min.js' %}"></script>

<script>
    $(function () {
        $('#datepicker').datepicker({
            autoclose:true,
            language:"zh-TW"
        })
    })
</script>

<script>
    $(function () {
      $('#selectStockTable').DataTable({
        'paging'      : true,
        'lengthChange': true,
        'searching'   : true,
        'ordering'    : true,
        'info'        : false,
        'autoWidth'   : true
      })
    })
    $(function () {
      $('#stockTable').DataTable({
        'paging'      : false,
        'lengthChange': true,
        'searching'   : false,
        'ordering'    : true,
        'info'        : false,
        'autoWidth'   : true
      })
    })
  </script>
{% endblock %}